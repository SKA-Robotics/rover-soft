<launch>
    <arg name="rviz" default="true" />
    <arg name="message_rate" default="10.0" />
    <arg name="camera_frame" default="camera_frame" />
    <arg name="manip_frame" default="base_link" />
    <arg name="camera_name" default="fake_camera" />
    <arg name="aruco_size" default="0.05" />
    <arg name="aruco_size_override" default="13-14: 0.032" /> <!-- e.g. "1-10: 0.1, 12: 0.2" -->

    <node name="aruco_detect" pkg="aruco_detect" type="aruco_detect">
        <param name="dictionary" value="16" /> <!-- DICT_ARUCO_ORIGINAL -->
        <param name="publish_images" value="true" />
        <param name="fiducial_len" value="$(arg aruco_size)" />
        <param name="fiducial_len_override" value="$(arg aruco_size_override)" />
        <remap from="/camera" to="$(arg camera_name)/image" />
        <remap from="/camera_info" to="$(arg camera_name)/camera_info" />
    </node>

    <node name="panel_tracker" pkg="panel_visualization" type="panel_tracker.py"
        output="screen">
        <param name="message_rate" value="$(arg message_rate)" />
        <param name="filter_size" value="10" />
        <param name="marker_length" value="$(arg aruco_size)" />
        <param name="marker_lengths_override" value="$(arg aruco_size_override)" />
        <rosparam file="$(find panel_visualization)/config/visual_objects.yaml" command="load" />
    </node>

    <node name="static_transform_publisher_0" pkg="tf2_ros" type="static_transform_publisher"
        args="0 0 0 0.5 -0.5 0.5 -0.5 $(arg manip_frame) $(arg camera_frame)" />

    <node if="$(arg rviz)" name="rviz" pkg="rviz" type="rviz" output="screen"
        args="-d $(find panel_visualization)/rviz/test_config.rviz" />

    <!-- TEST fake stream from images -->
    <node name="fake_camera" pkg="panel_visualization" type="fake_camera.py" output="screen">
        <param name="message_rate" value="$(arg message_rate)" />
        <param name="frame_id" value="$(arg camera_frame)" />
        <param name="camera_name" value="$(arg camera_name)" />
    </node>

</launch>